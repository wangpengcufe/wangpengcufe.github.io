<!DOCTYPE HTML><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta name="baidu-site-verification" content="kZmc8XTvrB"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?458cfc1440d057b6b8799400c6b2e2bf";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><meta charset="utf-8"><title>案例（二）如何把python项目部署到linux服务器上 | 机器学习 and 数据科学</title><meta name="author" content="王小鹏  京ICP备19037345号-1"><meta name="keywords" content="python项目部署，linux服务器 PDF电子书下载,电子书，PDF下载"><meta name="description" content="PDF电子书下载,电子书，PDF下载"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta property="og:title" content="案例（二）如何把python项目部署到linux服务器上"><meta property="og:site_name" content="机器学习 and 数据科学"><meta property="og:image" content><link href="/favicon.png" rel="icon"><link rel="alternate" href="/atom.xml" title="机器学习 and 数据科学" type="application/atom+xml"><link rel="stylesheet" href="/css/style.css" media="screen" type="text/css"><!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]--></head><body><header id="header" class="inner"><div class="alignleft"><h1><a href="/">机器学习 and 数据科学</a></h1><h2><a href="/">明天幸福今天修</a></h2></div><nav id="main-nav" class="alignright"><ul><li><a href="/">首页</a></li><li><a href="/archives">归档</a></li><li><a href="/about">关于</a></li></ul><div class="clearfix"></div></nav><div class="clearfix"></div></header><div id="content" class="inner"><div id="main-col" class="alignleft"><div id="wrapper"><article id="post-python-python2" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting"><div class="post-content"><header><div class="icon"></div><time class="dt-published" datetime="2020-01-02T15:28:56.000Z"><a href="/machinelearning/python-python2/">2020-01-02</a><span id="busuanzi_container_page_pv"> &nbsp;&nbsp;&nbsp;&nbsp;阅读 <span id="busuanzi_value_page_pv"></span></span></time><h1 class="p-name title" itemprop="headline name">案例（二）如何把python项目部署到linux服务器上</h1></header><div class="e-content entry" itemprop="articleBody"><p><img src="http://wangpengcufe.com/python%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2linux%E6%9C%8D%E5%8A%A1%E5%99%A8.png" alt="Python项目部署"></p><h1 id="一、案例背景"><a href="#一、案例背景" class="headerlink" title="一、案例背景"></a><strong>一、案例背景</strong></h1><p>用Python写了个脚本，需要部署到Linux环境的服务器上，由于服务器linux系统（centos,redhat等）自带的是python2，现在的python萌新都是从python3开始学习，所以需要给服务器配置一个python3环境，一番摸索过后，踩过一些坑，也总结了一下经验，故留此文。</p><h1 id="二、主要应用技术"><a href="#二、主要应用技术" class="headerlink" title="二、主要应用技术"></a><strong>二、主要应用技术</strong></h1><h2 id="2-1、linux-命令"><a href="#2-1、linux-命令" class="headerlink" title="2.1、linux 命令"></a><strong>2.1、linux 命令</strong></h2><p><img src="http://wangpengcufe.com/python2-1.png" alt="linux命令"></p><h1 id="三、实施步骤"><a href="#三、实施步骤" class="headerlink" title="*三、实施步骤 *"></a>*<em>三、实施步骤 *</em></h1><h3 id="3-1、安装python3"><a href="#3-1、安装python3" class="headerlink" title="3.1、安装python3"></a><strong>3.1、安装python3</strong></h3><p>开始安装之前先看一下机器的环境，主要看一下操作系他的环境和python版本。<br>查看环境<br>操作系统:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@reportweb]#  cat /etc/redhat-release</span><br><span class="line">CentOS release 6.5 (Final)</span><br></pre></td></tr></table></figure><p>查看python版本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@reportweb]# python -V</span><br><span class="line">Python 2.6.6</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@reportweb]# python3 -V</span><br><span class="line">-bash: python3: command not found</span><br></pre></td></tr></table></figure><p>可以看到操作系统是CentOS 6.5 ，python此时只有一个python2，没有python 3 。</p><p>下面开始进入正式安装：<br>第1步：下载python安装包，准备编译环境：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@reportweb]# yum install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gcc make</span><br></pre></td></tr></table></figure><p>第2步：下载python源码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@reportweb src]# wget https://www.python.org/ftp/python/3.6.6/Python-3.6.6.tgz</span><br></pre></td></tr></table></figure><p>第3步：解压</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@reportweb src]# tar -zxvf Python-3.6.6.tgz</span><br></pre></td></tr></table></figure><p>第4步：安装，编译</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@reportweb src]# cd Python-3.6.2</span><br><span class="line">[root@reportweb Python-3.6.2] # mkdir /usr/local/python3.6</span><br><span class="line">[root@reportweb Python-3.6.2] # ./configure --prefix=/usr/local/python3.6</span><br><span class="line">[root@reportweb Python-3.6.2] # make</span><br><span class="line">[root@reportweb Python-3.6.2] # make install</span><br></pre></td></tr></table></figure><p>第5步：建立软链</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@reportweb Python-3.6.2] # ln -s /usr/local/python3.6/bin/python3.6  /usr/bin/python3</span><br></pre></td></tr></table></figure><p>第6步：查询python版本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@reportweb]# python3 -V</span><br><span class="line">Python 3.6.6</span><br><span class="line"></span><br><span class="line">[root@reportweb]# python -V</span><br><span class="line">Python 2.6.6</span><br></pre></td></tr></table></figure><p>至此，python3安装完毕。</p><h3 id="3-2、安装pip3"><a href="#3-2、安装pip3" class="headerlink" title="3.2、安装pip3"></a><strong>3.2、安装pip3</strong></h3><p>下面开始安装pip3的步骤。<br>第1步：安装setuptools</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@reportweb src]# wget --no-check-certificate  https://pypi.python.org/packages/source/s/setuptools/setuptools-19.6.tar.gz#md5=c607dd118eae682c44ed146367a17e26</span><br></pre></td></tr></table></figure><p>第2步：解压</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@reportweb src]# tar -zxvf setuptools-19.6.tar.gz</span><br></pre></td></tr></table></figure><p>第3步：编译,安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@reportweb src] # cd setuptools-19.6/</span><br><span class="line">[root@reportweb setuptools-19.6] # python3 setup.py build</span><br><span class="line">[root@reportweb setuptools-19.6] # python3 setup.py install</span><br></pre></td></tr></table></figure><p>第4步：建立软链</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@reportweb setuptools-19.6] #  ln -s /usr/local/python3.6/bin/pip3 /usr/bin/pip3</span><br></pre></td></tr></table></figure><p>第5步：查看pip3版本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@reportweb] # pip3 -V</span><br><span class="line">pip 8.0.2 from /usr/local/python3.6/lib/python3.6/site-packages/pip-8.0.2-py3.6.egg (python 3.6)</span><br></pre></td></tr></table></figure><p>第6步：更新</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@reportweb] # pip3 install --upgrade pip</span><br><span class="line">Collecting pip</span><br><span class="line">  Downloading https://files.pythonhosted.org/packages/00/b6/9cfa56b4081ad13874b0c6f96af8ce16cfbc1cb06bedf8e9164ce5551ec1/pip-19.3.1-py2.py3-none-any.whl (1.4MB)</span><br><span class="line">    100% |████████████████████████████████| 1.4MB 172kB/s </span><br><span class="line">Installing collected packages: pip</span><br><span class="line">  Found existing installation: pip 8.0.2</span><br><span class="line">    Uninstalling pip-8.0.2:</span><br><span class="line">      Successfully uninstalled pip-8.0.2</span><br><span class="line">Successfully installed pip-19.3.1</span><br><span class="line">[root@reportweb]# pip3 -V</span><br><span class="line">pip 19.3.1 from /usr/local/python3.6/lib/python3.6/site-packages/pip (python 3.6)</span><br></pre></td></tr></table></figure><p>至此，pip3安装完毕。</p><h3 id="3-3、启动服务"><a href="#3-3、启动服务" class="headerlink" title="3.3、启动服务"></a><strong>3.3、启动服务</strong></h3><p>启动服务分为前台启动和后台启动。</p><p>前台启动，就是应用直接由窗口运行，能在窗口直接打印出日志信息，如果手动 ctrl + C 打断时，应用停止。当使用前台启动时，如果我们退出终端，服务就会停止。<br>后台启动，就是用nohup等命令，执行应用，在窗口关闭后，或者 执行其他命令时，该应用仍然可以再后台运行。</p><p>使用前台启动python项目：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@reportweb]# python3 test.py</span><br><span class="line">2020-01-02 16:00:47 读取原日志信息：00:00:01.560 [http-nio-8605-exec-5] [DEBUG] Bound request context to thread: org.apache.catalina.connector.RequestFacade@2dc071e6 org.springframework.boot.web.filter.OrderedRequestContextFilter [RID:] [TID:] [MID:]</span><br><span class="line">2020-01-02 16:00:47 转换格式前信息：00:00:01.560 [http-nio-8605-exec-5] [DEBUG] Bound request context to thread: org.apache.catalina.connector.RequestFacade@2dc071e6 org.springframework.boot.web.filter.OrderedRequestContextFilter [RID:] [TID:] [MID:]</span><br><span class="line">^CTraceback (most recent call last):</span><br><span class="line">  File &quot;test.py&quot;, line 174, in &lt;module&gt;</span><br><span class="line">    read_rawlog()</span><br><span class="line">  File &quot;test.py&quot;, line 79, in read_rawlog</span><br><span class="line">    line_json = log_data_to_json(line_temp)</span><br><span class="line">  File &quot;test.py&quot;, line 120, in log_data_to_json</span><br><span class="line">    logger = re.findall(logger_rule, line)</span><br><span class="line">  File &quot;/usr/python3/lib/python3.6/re.py&quot;, line 222, in findall</span><br><span class="line">    return _compile(pattern, flags).findall(string)</span><br><span class="line">KeyboardInterrupt</span><br><span class="line">[root@reportweb data]#</span><br></pre></td></tr></table></figure><p>前台会输出正常的日志信息，直到你按下 ctrl + c 打断它，就会报KeyboardInterrupt。<br>下面演示后台启动python文件：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@reportweb data]# nohup python3 test.py &amp;</span><br></pre></td></tr></table></figure><p>简单介绍一下nohup 命令</p><p>用途：不挂断地运行命令。</p><p>语法：nohup Command [ Arg … ] [　&amp; ]</p><p>描述：如果你正在运行一个进程，而且你觉得在退出帐户时该进程还不会结束，那么可以使用nohup命令。该命令可以在你退出帐户/关闭终端之后继续运行相应的进程。nohup就是不挂起的意思( no hang up)。nohup 执行 默认会自动生成一个 nohup.out 记录文件。</p><h3 id="3-4、停止服务"><a href="#3-4、停止服务" class="headerlink" title="3.4、停止服务"></a><strong>3.4、停止服务</strong></h3><p>前台启动的服务，直接 ctrl + c 停止服务，或者退出终端，服务就会停止。</p><p>后台启动的服务，用命令查看pid，然后 kill -9 pid 杀死任务。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@reportweb]# ps -ef|grep python</span><br><span class="line">root      9233  2598 95 16:22 pts/0    00:00:16 python3 test.py</span><br><span class="line">root      9244  2598  0 16:22 pts/0    00:00:00 grep python</span><br><span class="line">[root@reportweb]# kill -9 9233</span><br><span class="line">[root@reportweb]# ps -ef|grep python</span><br><span class="line">[root@reportweb]# ps -ef|grep python</span><br><span class="line">root      9257  2598  0 16:23 pts/0    00:00:00 grep python</span><br><span class="line">[1]+  已杀死               nohup python3 test.py</span><br></pre></td></tr></table></figure><h3 id="3-5、查看python执行的日志"><a href="#3-5、查看python执行的日志" class="headerlink" title="3.5、查看python执行的日志"></a><strong>3.5、查看python执行的日志</strong></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">查看前10行命令：</span><br><span class="line">[root@reportweb]# head -n 10 nohup.out</span><br><span class="line"></span><br><span class="line">查看后10行命令：</span><br><span class="line">[root@reportweb]# tail -n 10 nohup.out</span><br><span class="line"></span><br><span class="line">显示文件 nohup.log 的内容，从第 20 行至文件末尾:</span><br><span class="line">[root@reportweb]# tail +20 nohup.out</span><br><span class="line"></span><br><span class="line">要跟踪名为 nohup.log 的文件的增长情况，请输入以下命令：</span><br><span class="line">[root@reportweb]# tail -f nohup.out</span><br></pre></td></tr></table></figure><p>tail -f filename 会把 filename 文件里的最尾部的内容显示在屏幕上，并且不断刷新，只要 filename 更新就可以看到最新的文件内容。</p><p>命令格式：<br>tail [参数] [文件]<br>参数：</p><p>-f 循环读取<br>-q 不显示处理信息<br>-v 显示详细的处理信息<br>-c&lt;数目&gt; 显示的字节数<br>-n&lt;行数&gt; 显示文件的尾部 n 行内容<br>–pid=PID 与-f合用,表示在进程ID,PID死掉之后结束<br>-q, –quiet, –silent 从不输出给出文件名的首部<br>-s, –sleep-interval=S 与-f合用,表示在每次反复的间隔休眠S秒</p></div><footer><div class="categories"><a href="/categories/machinelearning/">机器学习</a></div><div class="tags"><a href="/tags/content/">content</a>, <a href="/tags/machine-learning/">machine learning</a></div><div class="addthis addthis_toolbox addthis_default_style"><a class="addthis_button_facebook_like" fb:like:layout="button_count"></a> <a class="addthis_button_pinterest_pinit" pi:pinit:layout="horizontal"></a> <a class="addthis_counter addthis_pill_style"></a></div><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js"></script><div class="clearfix"></div></footer></div></article><section id="comment"><h1 class="title">留言</h1><div id="fb-root"></div><script>!function(e,t,n){var a,c=e.getElementsByTagName(t)[0];e.getElementById(n)||((a=e.createElement(t)).id=n,a.src="//connect.facebook.net/en_US/all.js#xfbml=1&appId=123456789012345",c.parentNode.insertBefore(a,c))}(document,"script","facebook-jssdk")</script><div class="fb-comments" data-href="http://www.wangpengcufe.com/machinelearning/python-python2/index.html" data-num-posts="5" data-width="840" data-colorscheme="light"></div></section></div></div><aside id="sidebar" class="alignright"><script language="javascript">function search(e){return e.method="get",e.action="http://www.baidu.com/baidu",document.search_form.word.value=document.search_form.word.value,!0}</script><div class="search"><form name="search_form" target="_blank" onsubmit="search(this)"><input type="search" name="word" results="0" placeholder="百度站内搜索" onblur='this.value=""'></form></div><div class="widget tag"><h3 class="title">分类</h3><ul class="entry"><li><a href="/categories/read/">read</a><small>63</small></li><li><a href="/categories/tools/">工具</a><small>2</small></li><li><a href="/categories/machinelearning/">机器学习</a><small>21</small></li><li><a href="/categories/navigate/">菜单导航</a><small>1</small></li><li><a href="/categories/datadownload/">资料下载</a><small>1</small></li></ul></div><div class="widget tag"><h3 class="title">标签</h3><ul class="entry"><li><a href="/tags/content/">content</a><small>85</small></li><li><a href="/tags/library/">library</a><small>1</small></li><li><a href="/tags/machine-learning/">machine learning</a><small>21</small></li><li><a href="/tags/navigate/">navigate</a><small>1</small></li><li><a href="/tags/tools/">tools</a><small>2</small></li></ul></div><div class="widget tag"><h3 class="title">友情链接</h3><ul class="entry"><li><a href="http://blog.didispace.com" title="程序员DD">程序员DD</a></li><li><a href="https://mangoroom.cn" title="芒果的个人博客">芒果的个人博客</a></li><li><a href="http://www.baimin.com" target="_blank">百鸣网站百科</a></li><li><a href="http://blog.sina.com.cn/u/2435344920" target="_blank">默默读书</a></li><li><a href="https://www.jianshu.com/u/510007ddad06" target="_blank">王小鹏的随笔（简书）</a></li><li><a href="https://me.csdn.net/weixin_42438712" target="_blank">机器学习（csdn博客）</a></li><li><a href="https://zhuanlan.zhihu.com/c_1182309165824901120" target="_blank">机器学习（知乎）</a></li><li><a href="http://meixiaohan.com/" target="_blank">小寒大人的blog</a></li><li><a href="https://baippt.com/" target="_blank">ppt模板免费下载</a></li><li><a href="http://www.youneedcn.com/" target="_blank">你要的资源</a></li></ul></div></aside><div class="clearfix"></div></div><footer id="footer" class="inner"><div class="alignleft">&copy; 2020 王小鹏 京ICP备19037345号-1</div><div class="clearfix"></div><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></footer><script src="//ajax.useso.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script><script src="/js/jquery.imagesloaded.min.js"></script><script src="/js/gallery.js"></script><link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css"><script src="/fancybox/jquery.fancybox.pack.js"></script><script type="text/javascript">jQuery(".fancybox").fancybox()</script></body></html>