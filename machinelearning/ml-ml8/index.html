<!DOCTYPE HTML><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta name="baidu-site-verification" content="kZmc8XTvrB"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?458cfc1440d057b6b8799400c6b2e2bf";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><meta charset="utf-8"><title>机器学习（八） 主成分分析（PCA） | 机器学习 and 数据科学</title><meta name="author" content="王小鹏  京ICP备19037345号-1"><meta name="description" content="机器学习 王鹏 数据科学"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta property="og:title" content="机器学习（八） 主成分分析（PCA）"><meta property="og:site_name" content="机器学习 and 数据科学"><meta property="og:image" content><link href="/favicon.png" rel="icon"><link rel="alternate" href="/atom.xml" title="机器学习 and 数据科学" type="application/atom+xml"><link rel="stylesheet" href="/css/style.css" media="screen" type="text/css"><!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]--></head><body><header id="header" class="inner"><div class="alignleft"><h1><a href="/">机器学习 and 数据科学</a></h1><h2><a href="/">明天幸福今天修</a></h2></div><nav id="main-nav" class="alignright"><ul><li><a href="/">首页</a></li><li><a href="/archives">归档</a></li><li><a href="/about">关于</a></li></ul><div class="clearfix"></div></nav><div class="clearfix"></div></header><div id="content" class="inner"><div id="main-col" class="alignleft"><div id="wrapper"><article id="post-ml-ml8" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting"><div class="post-content"><header><div class="icon"></div><time class="dt-published" datetime="2019-09-04T10:42:05.000Z"><a href="/machinelearning/ml-ml8/">2019-09-04</a><span id="busuanzi_container_page_pv"> &nbsp;&nbsp;&nbsp;&nbsp;阅读 <span id="busuanzi_value_page_pv"></span></span></time><h1 class="p-name title" itemprop="headline name">机器学习（八） 主成分分析（PCA）</h1></header><div class="e-content entry" itemprop="articleBody"><p>标签： machine learning</p><p><img src="/machinelearning/ml-ml8/1.png" alt="目录"></p><a id="more"></a><h1 id="一、概念"><a href="#一、概念" class="headerlink" title="一、概念"></a><strong>一、概念</strong></h1><p>主成分分析（Principal Component Analysis）是指将多个变量通过线性变换以选出较少数重要变量的一种多元统计分析方法，又称为主成分分析。在实际应用场合中，为了全面分析问题，往往提出很多与此有关的变量（或因素），因为每个变量都在不同程度上反映这个应用场合的某些信息。</p><p>主成分分析是设法将原来众多具有一定相关性（比如N个指标）的指标，重新组合成一组新的相互无关的综合指标来代替原来的指标，从而实现数据降维的目的，这也是MLlib的处理手段之一。</p><h1 id="二、代码实现"><a href="#二、代码实现" class="headerlink" title="二、代码实现"></a><strong>二、代码实现</strong></h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">import org.apache.spark.SparkConf;</span><br><span class="line">import org.apache.spark.api.java.JavaRDD;</span><br><span class="line">import org.apache.spark.api.java.JavaSparkContext;</span><br><span class="line">import org.apache.spark.mllib.feature.PCA;</span><br><span class="line">import org.apache.spark.mllib.feature.PCAModel;</span><br><span class="line">import org.apache.spark.mllib.linalg.Matrix;</span><br><span class="line">import org.apache.spark.mllib.linalg.Vector;</span><br><span class="line">import org.apache.spark.mllib.linalg.Vectors;</span><br><span class="line">import org.apache.spark.mllib.linalg.distributed.RowMatrix;</span><br><span class="line">import org.apache.spark.mllib.regression.LabeledPoint;</span><br><span class="line">import org.apache.spark.rdd.RDD;</span><br><span class="line"></span><br><span class="line">SparkConf conf = new  SparkConf().setAppName(&quot;PCA&quot;).setMaster(&quot;local&quot;);</span><br><span class="line">JavaSparkContext sc = new  JavaSparkContext(conf);</span><br><span class="line">        </span><br><span class="line">/**</span><br><span class="line">  *  使用test.data矩阵</span><br><span class="line">     1 2 3 4 5 6 7 8 9</span><br><span class="line">     5 6 7 8 9 0 8 6 7</span><br><span class="line">     9 0 8 7 1 4 3 2 1</span><br><span class="line">     6 4 2 1 3 4 2 1 5</span><br><span class="line">  */</span><br><span class="line">JavaRDD&lt;String&gt; source =  sc.textFile(&quot;data/mllib/test.data&quot;);</span><br><span class="line">JavaRDD&lt;Vector&gt; data =  source.map(line-&gt;&#123;</span><br><span class="line">     String[] parts = line.split(&quot; &quot;);</span><br><span class="line">     return  Vectors.dense(Double.parseDouble(parts[0]),</span><br><span class="line">             Double.parseDouble(parts[1]),</span><br><span class="line">             Double.parseDouble(parts[2]),</span><br><span class="line">             Double.parseDouble(parts[3]),</span><br><span class="line">             Double.parseDouble(parts[4]),</span><br><span class="line">             Double.parseDouble(parts[5]),</span><br><span class="line">             Double.parseDouble(parts[6]),</span><br><span class="line">             Double.parseDouble(parts[7]),</span><br><span class="line">             Double.parseDouble(parts[8]));</span><br><span class="line">&#125;);</span><br><span class="line">data.foreach(x-&gt;&#123;</span><br><span class="line">     System.out.println(x);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>控制台输出结果</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0]</span><br><span class="line">[5.0,6.0,7.0,8.0,9.0,0.0,8.0,6.0,7.0]</span><br><span class="line">[9.0,0.0,8.0,7.0,1.0,4.0,3.0,2.0,1.0]</span><br><span class="line">[6.0,4.0,2.0,1.0,3.0,4.0,2.0,1.0,5.0]</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RowMatrix rm = new  RowMatrix(data.rdd());</span><br><span class="line">Matrix pc =  rm.computePrincipalComponents(3);</span><br><span class="line">System.out.println(pc);</span><br></pre></td></tr></table></figure><p>控制台输出结果</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-0.41267731212833847   -0.3096216957951525    0.1822187433607524    </span><br><span class="line">0.22357946922702987    -0.08150768817940773   0.5905947537762997    </span><br><span class="line">-0.08813803143909382   -0.5339474873283436    -0.2258410886711858   </span><br><span class="line">0.07580492185074224   -0.56869017430423       -0.28981327663106565  </span><br><span class="line">0.4399389896865264     -0.23105821586820194   0.3185548657550075    </span><br><span class="line">-0.08276152212493619  0.3798283369681188      -0.4216195003799105   </span><br><span class="line">0.3952116027336311     -0.19598446496556066   -0.17237034054712738  </span><br><span class="line">0.43580231831608096    -0.023441639969444372  -0.4151661847170216   </span><br><span class="line">0.468703853681766     0.2288352748369381      0.04103087747663084</span><br></pre></td></tr></table></figure><p>可以看到，主成分矩阵是一个尺寸为(9,3)的矩阵，其中每一列代表一个主成分（新坐标轴），每一行代表原有的一个特征，而a.data矩阵可以看成是一个有4个样本，9个特征的数据集，那么，主成分矩阵相当于把原有的9维特征空间投影到一个3维的空间中，从而达到降维的效果。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">RowMatrix rm2 = rm.multiply(pc);</span><br><span class="line">RDD&lt;Vector&gt; v = rm2.rows();</span><br><span class="line">JavaRDD&lt;Vector&gt; vector = v.toJavaRDD();</span><br><span class="line">vector.foreach(x-&gt;&#123;</span><br><span class="line">   System.out.println(x);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>控制台输出结果</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[12.247647483894383,-2.725468189870252,-5.568954759405281]</span><br><span class="line">[12.284448024169402,-12.510510992280857,-0.16048149283293078]</span><br><span class="line">[-1.2537294080109986,-10.15675264890709,-4.8697886049036025]</span><br><span class="line">[2.8762985358626505,-2.2654415718974685,1.428630138613534]</span><br></pre></td></tr></table></figure><p>MLlib提供的PCA变换方法最多只能处理65535维的数据。</p><p><strong>参考资料</strong>：</p><ul><li><a href="http://spark.apache.org/docs/latest/mllib-dimensionality-reduction.html" title="http://spark.apache.org/docs/latest/mllib-dimensionality-reduction.html" target="_blank" rel="noopener">http://spark.apache.org/docs/latest/mllib-dimensionality-reduction.html</a></li></ul></div><footer><div class="categories"><a href="/categories/machinelearning/">机器学习</a></div><div class="tags"><a href="/tags/content/">content</a>, <a href="/tags/machine-learning/">machine learning</a></div><div class="addthis addthis_toolbox addthis_default_style"><a class="addthis_button_facebook_like" fb:like:layout="button_count"></a> <a class="addthis_button_pinterest_pinit" pi:pinit:layout="horizontal"></a> <a class="addthis_counter addthis_pill_style"></a></div><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js"></script><div class="clearfix"></div></footer></div></article><section id="comment"><h1 class="title">留言</h1><div id="fb-root"></div><script>!function(e,t,n){var a,c=e.getElementsByTagName(t)[0];e.getElementById(n)||((a=e.createElement(t)).id=n,a.src="//connect.facebook.net/en_US/all.js#xfbml=1&appId=123456789012345",c.parentNode.insertBefore(a,c))}(document,"script","facebook-jssdk")</script><div class="fb-comments" data-href="http://wangpengcufe.github.io/machinelearning/ml-ml8/index.html" data-num-posts="5" data-width="840" data-colorscheme="light"></div></section></div></div><aside id="sidebar" class="alignright"><script language="javascript">function search(e){return e.method="get",e.action="http://www.baidu.com/baidu",document.search_form.word.value=document.search_form.word.value,!0}</script><div class="search"><form name="search_form" target="_blank" onsubmit="search(this)"><input type="search" name="word" results="0" placeholder="百度站内搜索" onblur='this.value=""'></form></div><div class="widget tag"><h3 class="title">分类</h3><ul class="entry"><li><a href="/categories/read/">read</a><small>54</small></li><li><a href="/categories/tools/">工具</a><small>2</small></li><li><a href="/categories/machinelearning/">机器学习</a><small>13</small></li><li><a href="/categories/navigate/">菜单导航</a><small>1</small></li></ul></div><div class="widget tag"><h3 class="title">标签</h3><ul class="entry"><li><a href="/tags/content/">content</a><small>68</small></li><li><a href="/tags/machine-learning/">machine learning</a><small>13</small></li><li><a href="/tags/navigate/">navigate</a><small>1</small></li><li><a href="/tags/tools/">tools</a><small>2</small></li></ul></div><div class="widget tag"><h3 class="title">友情链接</h3><ul class="entry"><li><a href="http://blog.didispace.com" title="程序员DD">程序员DD</a></li><li><a href="https://mangoroom.cn" title="芒果的个人博客">芒果的个人博客</a></li><li><a href="http://www.baimin.com" target="_blank">百鸣网站百科</a></li><li><a href="http://blog.sina.com.cn/u/2435344920" target="_blank">默默读书</a></li></ul></div></aside><div class="clearfix"></div></div><footer id="footer" class="inner"><div class="alignleft">&copy; 2019 王小鹏 京ICP备19037345号-1</div><div class="clearfix"></div><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></footer><script src="//ajax.useso.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script><script src="/js/jquery.imagesloaded.min.js"></script><script src="/js/gallery.js"></script><link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css"><script src="/fancybox/jquery.fancybox.pack.js"></script><script type="text/javascript">jQuery(".fancybox").fancybox()</script></body></html>